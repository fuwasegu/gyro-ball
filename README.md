# Gyro Ball

ジャイロセンサーを使ってボールを転がし、画面を塗りつぶすWebアプリケーションです。

> [!TIP]
> このアプリケーションは，作者が Cursor を使って AI に指示をしただけで作ったものです．

## ゲームモード

### 自由モード

- 時間制限なしで自由に遊べるモード
- ボールのサイズをいつでも変更可能
- リセットボタンでいつでもやり直し可能
- 100%塗りつぶすと達成モーダルを表示

### タイムアタックモード

- 制限時間内に100%塗りつぶすことを目指すモード
- ボールサイズによって制限時間が変化
  - 小サイズ：10分（繊細な操作が必要）
  - 中サイズ：5分（バランスの取れた難易度）
  - 大サイズ：2分（広範囲を塗れる）
  - 特大サイズ：1分（超高難度チャレンジ）
- スタートボタンを押すと3秒カウントダウン
- プレイ中はボールサイズの変更とリセットが不可
- 結果表示
  - 成功：制限時間内に100%達成
  - 失敗：残りの塗り残し%を表示

## 機能

- デバイスの傾きに応じてボールが転がります
- ボールの軌跡が黒く塗られていきます
- 塗られた面積のパーセンテージがリアルタイムで表示されます
- ボールのサイズを4段階で変更可能
  - 小：繊細な塗り込みが可能
  - 中：バランスの取れた操作性
  - 大：広範囲を塗れる
  - 特大：超広範囲を一気に塗れる（タイムアタック用）
- リセットボタンで軌跡を消去可能
- 摩擦による減速効果があり、自然な動きを実現
- 画面の端までボールを移動可能
- レスポンシブデザインで様々な画面サイズに対応
  - スマートフォンの画面サイズに最適化
  - 縦画面でも横画面でも快適に操作可能
- iOSデバイスでのジャイロセンサー権限管理に対応
  - 初回起動時にモーダルで権限リクエスト
  - 分かりやすい説明文で使用目的を明示
- 固定ヘッダーでタイトルを常時表示

## 遊び方

1. スマートフォンやタブレットでアクセス
2. 初回起動時に表示されるモーダルで、ジャイロセンサーへのアクセスを許可
3. プレイしたいモードを選択（自由モード or タイムアタックモード）
4. ボールのサイズを選択
   - 自由モード：好きなサイズを自由に選択
   - タイムアタックモード：制限時間を考慮してサイズを選択
     - 特大サイズは1分の超高難度チャレンジ
5. タイムアタックモードの場合はスタートボタンを押してカウントダウン開始
6. デバイスを傾けてボールを操作し、画面を塗りつぶす
7. 目標達成（100%塗りつぶし）を目指す

## 技術スタック

- TypeScript
- SvelteKit
- HTML5 Canvas
- DeviceOrientation API

## ファイル構造

```shell
src/
├── routes/
│   └── +page.svelte      # メインページコンポーネント
├── components/
│   ├── Ball.svelte       # ボールの描画コンポーネント
│   ├── Canvas.svelte     # キャンバス操作コンポーネント
│   ├── Controls.svelte   # UI制御コンポーネント
│   ├── Header.svelte     # ヘッダーコンポーネント
│   ├── ModeSelector.svelte  # ゲームモード選択コンポーネント
│   ├── TimeAttack.svelte   # タイムアタック用コンポーネント
│   ├── ResultModal.svelte  # 結果表示モーダル
│   └── PermissionModal.svelte  # 権限リクエストモーダル
├── lib/
│   ├── physics.ts        # 物理演算関連の関数
│   └── gyroscope.ts      # ジャイロセンサー関連の関数
└── types/
    └── index.ts          # 型定義
```

### コンポーネント設計

#### ModeSelector.svelte

- ゲームモードの切り替えを担当
- 自由モード��タイムアタックモードの選択UI
- アクティブなモードの視覚的表示
- レスポンシブ対応のボタンデザイン

#### TimeAttack.svelte

- タイムアタックモードの進行管理
- カウントダウン表示（3,2,1）
- 残り時間のタイマー表示
- ボールサイズに応じた制限時間の管理
- スタートボタンの提供

#### ResultModal.svelte

- ゲーム結果の表示を担当
- 成功時のお祝いメッセージ
- 失敗時の達成率表示
- モーダル形式での表示
- レスポンシブ対応のデザイン

#### PermissionModal.svelte

- ジャイロセンサーの権限リクエストを担当
- モーダルウィンドウでの表示
- 分かりやすい説明文の提供
- レスポンシブ対応のUI
- オーバーレイ効果による注目の集中
- アクセス許可後は自動的に非表示

#### Header.svelte

- アプリケーションのタイトルを表示
- 画面上部に固定表示（fixed position）
- レスポンシブ対応（画面サイズに応じて高さとフォントサイズを調整）
- シャドウ効果による視覚的な階層表現

#### Ball.svelte

- ボールの視覚的な表示を担当
- 位置とサイズに応じて動的にスタイルを適用
- CSSアニメーションによる滑らかな遷��効果

#### Canvas.svelte

- キャンバスの初期化と描画処理を管理
- ボールの軌跡を描画
- 塗られた面積の計算と通知
- キャンバスのリサイズ対応

#### Controls.svelte

- ユーザーインターフェースの提供
- ボールサイズの切り替え機能
- リセットボタンの提供
- 塗られた面積の表示
- タイムアタックモード中の操作制限

### ユーティリティモジュール

#### physics.ts

- ボールの物理演算を担当
- 速度と位置の計算
- 摩擦係数の適用
- 画面端での衝突判定

#### gyroscope.ts

- ジャイロセンサーへのアクセス管理
- iOS向けの権限リクエスト処理
- センサーデータの型定義

### 型定義（types/index.ts）

- `BallSize`: ボールサイズの列挙型
- `GameMode`: ゲームモードの列挙型
- `Position`: x, y座標を持つインターフェース
- `Velocity`: x, y方向の速度を持つインターフェース
- `BallSizeConfig`: ボールの半径と線幅の設定
- `DeviceOrientationEventStatic`: ジャイロセンサーイベントの型定義
- `TimeLimit`: タイムアタックモードの制限時間設定

## 開発環境のセットアップ

1 リポジトリのクローン

```bash
git clone https://github.com/your-username/gyro-ball.git
cd gyro-ball
```

2 依存関係のインストール

```bash
pnpm install
```

3 開発サーバーの起動

```bash
pnpm dev
```

4 ブラウザでアクセス

```text
http://localhost:5173
```

## 注意事項

- デバイスのジャイロセンサーが必要です
- HTTPSでの実行が推奨されます（一部ブラウザではHTTPSが必須）
- PCでは動作確認できません（ジャイロセンサーが必要なため）
